<!DOCTYPE html>
<html lang="en">

<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout:: head">
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div id="list">
    <h3 th:text="${msg}"></h3>
    <div class="form-inline my-2 my-lg-0">
        <input class="form-control mr-sm-2" type="search" placeholder="Title" aria-label="Search" id="search">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit" id="submitSearch">Search</button>
    </div>

    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col">ID</th>
            <th scope="col">Title</th>
            <th scope="col">Author</th>
            <th scope="col" colspan="3">Action</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="blog:${listBlog}">
            <td th:text="${blog.id}"></td>
            <td><a th:href="@{/detail/{id}(id=${blog.id})}" th:text="${blog.title}"></a></td>
            <td th:text="${blog.author}"></td>

            <td><a th:href="@{/detail/{id}(id=${blog.id})}" class="btn btn-primary">Detail</a></td>
            <td><a class="btn btn-primary detailBtn">Detail ajax</a>
                <input type="hidden" th:value="${blog.id}" />
            </td>
            <td><a th:href="@{/edit/__${blog.id}__}" class="btn btn-primary" id="Edit">Edit</a></td>
            <td><a th:href="@{/delete/{id}(id=${blog.id})}" onclick="return confirm('Are you sure to delete?')"
                   class="btn btn-danger">Delete</a></td>
        </tr>
        </tbody>
    </table>
    <a class="btn btn-primary" th:href="@{'/'(page=${listBlog.number - 1})}"
       th:if="${listBlog.hasPrevious()}">Previous</a>
    <a class="btn btn-success" th:text="${listBlog.number+1 }" th:href="@{'/'(page=${listBlog.number+1})}">/</a>
    <a class="btn btn-success" th:text="${listBlog.totalPages}"
       th:href="@{'/'(page=${listBlog.totalPages - 1})}"></a>
    <a class="btn btn-danger" th:href="@{'/'(page=${listBlog.number + 1})}" th:if="${listBlog.hasNext()}">Next</a>

    <!-- Modal -->
    <div class="modal fade" id="idModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    ...
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $("#submitSearch").click(function () {
            let search = $("#search").val();
            $.ajax({
                url: "/search",
                type: "GET",
                data: {"name": search},
                dataType: "HTML",
                success: function (data) {
                    $("#list").html(data);
                }
            })
        })

        $(".detailBtn").click(function () {
            let id = $(this).next().val();
            $.ajax({
                url: "/edit/" + id,
                type: "GET",
                dataType: "HTML",
                success: function (data) {
                    $(".modal-body").html(data);
                    $("#idModal").modal();
                }
            })
        })
    })

</script>
</body>
</html>